<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplication Game - SD Anak Saleh</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Quicksand', sans-serif;
            margin: 0; padding: 0; overflow: hidden;
            background: #f0f9ff;
            min-height: 100vh;
            display: flex; align-items: center; justify-content: center;
            transition: background 0.5s ease;
        }

        .title-font { font-family: 'Fredoka One', cursive; }

        /* Latar Belakang Lucu Animasi */
        .decoration {
            position: absolute; z-index: -1; pointer-events: none; opacity: 0.6;
        }
        
        .cloud {
            background: white; border-radius: 50px;
            animation: moveCloud linear infinite;
        }
        @keyframes moveCloud {
            from { transform: translateX(-200px); }
            to { transform: translateX(110vw); }
        }

        /* Card Utama */
        .game-card {
            background: rgba(255, 255, 255, 0.95);
            border: 10px solid #4ade80;
            border-radius: 50px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.15);
            width: 100%; max-width: 850px;
            position: relative;
            backdrop-filter: blur(5px);
        }

        /* Panggung Visual Besar */
        .visual-stage {
            background: rgba(248, 250, 252, 0.8);
            border-radius: 30px;
            border: 4px dashed #cbd5e1;
            min-height: 240px;
            display: flex; flex-wrap: wrap;
            justify-content: center; align-items: center;
            gap: 15px; padding: 25px;
            margin-bottom: 20px;
        }

        .group-container {
            background: white;
            padding: 15px; border-radius: 25px;
            border: 3px solid #e2e8f0;
            box-shadow: 0 8px 0 #f1f5f9;
            animation: popIn 0.5s ease-out forwards;
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            80% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .option-btn {
            transition: all 0.2s;
            border-bottom-width: 8px;
        }
        .option-btn:active:not(:disabled) {
            border-bottom-width: 0px;
            transform: translateY(8px);
        }

        .modal-ans {
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 100;
            align-items: center; justify-content: center; border-radius: 40px;
        }

        .shake { animation: shake 0.5s; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Tema Warna Per Level */
        .bg-easy { background: #dcfce7; } /* Hijau Muda */
        .bg-medium { background: #fef9c3; } /* Kuning Muda */
        .bg-hard { background: #fee2e2; } /* Merah Muda */
    </style>
</head>
<body class="bg-easy">

    <!-- Dekorasi Latar Belakang -->
    <div class="decoration cloud" style="width: 150px; height: 50px; top: 10%; animation-duration: 30s;"></div>
    <div class="decoration cloud" style="width: 220px; height: 70px; top: 30%; animation-duration: 45s; animation-delay: -5s;"></div>
    <div class="decoration text-8xl" style="bottom: 10%; left: 5%;">üå≥</div>
    <div class="decoration text-8xl" style="top: 15%; right: 8%;">‚òÄÔ∏è</div>
    <div class="decoration text-7xl" style="bottom: 15%; right: 5%;">üå∏</div>

    <div id="game-container" class="game-card overflow-hidden">
        
        <!-- Header Branding SD ANAK SALEH -->
        <div id="header-bg" class="bg-green-500 p-5 flex justify-between items-center transition-colors duration-500">
            <div class="flex items-center space-x-4">
                <div class="bg-white p-2 rounded-2xl shadow-lg">
                    <span class="text-3xl">üïå</span>
                </div>
                <div>
                    <h1 class="text-white font-black text-xl tracking-wider leading-none">SD ANAK SALEH</h1>
                    <p id="level-text" class="text-green-100 text-xs font-bold uppercase mt-1 tracking-widest tracking-tighter">PILIH TINGKAT KESULITAN</p>
                </div>
            </div>
            <div class="bg-white px-6 py-2 rounded-2xl shadow-lg text-center">
                <p class="text-[10px] font-black text-green-600 leading-none mb-1">SKOR</p>
                <span id="score" class="text-3xl font-black text-green-700 leading-none">0</span>
            </div>
        </div>

        <!-- Progress Bar -->
        <div id="progress-container" class="w-full h-3 bg-green-100 hidden">
            <div id="progress" class="h-full bg-yellow-400 transition-all duration-300" style="width: 0%"></div>
        </div>

        <!-- Main Area -->
        <div class="p-8">
            <!-- Layar Pilih Level -->
            <div id="start-screen" class="text-center space-y-8">
                <div class="text-9xl animate-bounce">üéÆ</div>
                <h2 class="title-font text-4xl text-green-600 leading-tight">Selamat Datang di<br>Petualangan Perkalian!</h2>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                    <button onclick="startGame('EASY')" class="bg-green-500 hover:bg-green-600 text-white p-6 rounded-3xl shadow-xl border-b-8 border-green-800 transition-all active:border-b-0 active:translate-y-2">
                        <span class="text-4xl block mb-2">üå±</span>
                        <span class="font-black text-xl">MUDAH</span>
                        <p class="text-xs opacity-80">(Perkalian 1-2)</p>
                    </button>
                    <button onclick="startGame('MEDIUM')" class="bg-yellow-500 hover:bg-yellow-600 text-white p-6 rounded-3xl shadow-xl border-b-8 border-yellow-800 transition-all active:border-b-0 active:translate-y-2">
                        <span class="text-4xl block mb-2">üåø</span>
                        <span class="font-black text-xl">SEDANG</span>
                        <p class="text-xs opacity-80">(Perkalian 3-4)</p>
                    </button>
                    <button onclick="startGame('HARD')" class="bg-red-500 hover:bg-red-600 text-white p-6 rounded-3xl shadow-xl border-b-8 border-red-800 transition-all active:border-b-0 active:translate-y-2">
                        <span class="text-4xl block mb-2">üå≥</span>
                        <span class="font-black text-xl">SULIT</span>
                        <p class="text-xs opacity-80">(Perkalian 5-9)</p>
                    </button>
                </div>
            </div>

            <!-- Area Soal -->
            <div id="question-screen" class="hidden">
                <div class="flex justify-between items-end mb-4">
                    <span id="q-count" class="bg-blue-100 text-blue-600 px-4 py-1 rounded-full font-bold text-sm">SOAL 1/10</span>
                    <button onclick="openKey()" class="bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-3 py-1 rounded-lg text-sm font-bold transition-all">
                        üóùÔ∏è Buka Kunci (-2 Poin)
                    </button>
                </div>

                <!-- Panggung Gambar Raksasa -->
                <div id="visual-aid" class="visual-stage">
                    <!-- Kelompok gambar muncul di sini -->
                </div>

                <div class="text-center mb-8">
                    <p id="math-display" class="title-font text-8xl text-blue-600 drop-shadow-md"></p>
                </div>

                <div id="options-grid" class="grid grid-cols-2 gap-6">
                    <!-- Tombol pilihan -->
                </div>
            </div>

            <!-- Hasil Akhir -->
            <div id="result-screen" class="hidden text-center space-y-8">
                <div id="final-emoji" class="text-[150px]">üèÜ</div>
                <h2 class="title-font text-5xl text-green-600">Misi Selesai!</h2>
                <p id="final-msg" class="text-2xl font-bold text-gray-600"></p>
                <div class="flex flex-col space-y-4 items-center">
                    <button onclick="location.reload()" class="bg-green-500 text-white px-10 py-4 rounded-full text-2xl font-black shadow-lg border-b-8 border-green-800 w-64">
                        PILIH LEVEL üîÑ
                    </button>
                </div>
            </div>
        </div>

        <!-- Kunci Jawaban Modal -->
        <div id="key-modal" class="modal-ans">
            <div class="bg-white p-10 rounded-[40px] shadow-2xl text-center space-y-6 border-8 border-yellow-400 max-w-xs scale-in">
                <p class="text-2xl font-black text-yellow-600">KUNCI RAHASIA</p>
                <div class="text-8xl font-black text-gray-800 title-font" id="key-value">?</div>
                <button onclick="closeKey()" class="bg-yellow-400 text-yellow-900 px-8 py-2 rounded-full font-bold">TUTUP</button>
            </div>
        </div>

        <!-- Feedback Bar -->
        <div id="feedback-bar" class="bg-gray-50 p-4 text-center border-t-2 border-gray-100 min-h-[60px] flex items-center justify-center">
            <p id="feedback" class="text-xl font-black text-gray-300">Siap untuk belajar? ‚ú®</p>
        </div>
    </div>

    <script>
        let score = 0, currentQ = 0, correctAns = 0, selectedDifficulty = 'EASY';
        const totalQ = 10; // Dikurangi jadi 10 per level agar tidak terlalu lama

        const praise = ["SD Anak Saleh Hebat! üåü", "Kamu Pintar Sekali! üèÜ", "Luar Biasa! üî•", "Keren! üëè", "Jenius Cilik! üß†"];
        const motiv = ["Coba lagi, pasti bisa! üí™", "Jangan menyerah ya! üöÄ", "Hampir saja! üßê", "Tetap semangat! üéà"];
        const icons = ['ü¶Å', 'üê∞', 'üêº', 'ü¶ä', 'üê∏', 'üêß', 'üç¨', 'üçâ', 'üç¶', 'üçì'];

        function startGame(difficulty) {
            selectedDifficulty = difficulty;
            score = 0; currentQ = 0;
            
            // Atur Latar Belakang & Header berdasarkan level
            const body = document.body;
            const header = document.getElementById('header-bg');
            const levelText = document.getElementById('level-text');
            
            if(difficulty === 'EASY') {
                body.className = "bg-easy";
                header.className = "bg-green-500 p-5 flex justify-between items-center transition-colors duration-500";
                levelText.innerText = "LEVEL: MUDAH";
            } else if(difficulty === 'MEDIUM') {
                body.className = "bg-medium";
                header.className = "bg-yellow-500 p-5 flex justify-between items-center transition-colors duration-500";
                levelText.innerText = "LEVEL: SEDANG";
            } else {
                body.className = "bg-hard";
                header.className = "bg-red-500 p-5 flex justify-between items-center transition-colors duration-500";
                levelText.innerText = "LEVEL: SULIT";
            }

            document.getElementById('score').innerText = score;
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            document.getElementById('question-screen').classList.remove('hidden');
            document.getElementById('progress-container').classList.remove('hidden');
            
            nextQuestion();
        }

        function nextQuestion() {
            if (currentQ >= totalQ) { showResult(); return; }
            currentQ++;
            
            let n1, n2;
            if (selectedDifficulty === 'EASY') {
                n1 = Math.floor(Math.random() * 2) + 1; // 1-2
                n2 = Math.floor(Math.random() * 5) + 1;
            } else if (selectedDifficulty === 'MEDIUM') {
                n1 = Math.floor(Math.random() * 2) + 3; // 3-4
                n2 = Math.floor(Math.random() * 6) + 1;
            } else {
                n1 = Math.floor(Math.random() * 5) + 5; // 5-9
                n2 = Math.floor(Math.random() * 7) + 2;
            }

            correctAns = n1 * n2;
            document.getElementById('q-count').innerText = `SOAL ${currentQ}/${totalQ}`;
            document.getElementById('math-display').innerText = `${n1} x ${n2}`;
            document.getElementById('progress').style.width = `${(currentQ/totalQ)*100}%`;

            // Visual Aid Raksasa
            const visual = document.getElementById('visual-aid');
            visual.innerHTML = '';
            const char = icons[Math.floor(Math.random() * icons.length)];
            
            // Batasi tampilan visual agar tidak terlalu penuh di level sulit
            const displayGroups = n1 > 6 ? 6 : n1; 
            
            for (let i = 0; i < displayGroups; i++) {
                let group = document.createElement('div');
                group.className = "group-container";
                let content = "";
                // Batasi emoji per group agar tidak meluap
                const displayItems = n2 > 8 ? 8 : n2;
                for (let j = 0; j < displayItems; j++) content += `<span class="text-4xl md:text-5xl mx-1">${char}</span>`;
                if(n2 > 8) content += `<span class="text-xl font-bold ml-1">...</span>`;
                
                group.innerHTML = `<div class="flex flex-wrap justify-center">${content}</div>`;
                visual.appendChild(group);
            }
            if(n1 > 6) {
                let more = document.createElement('div');
                more.className = "text-2xl font-black text-gray-400 ml-4";
                more.innerText = "+ Kelompok lainnya...";
                visual.appendChild(more);
            }

            // Pilihan Jawaban
            const opts = new Set([correctAns]);
            while (opts.size < 4) {
                let salt = Math.floor(Math.random() * (correctAns + 10)) + 1;
                if(salt > 0) opts.add(salt);
            }
            
            const grid = document.getElementById('options-grid');
            grid.innerHTML = '';
            Array.from(opts).sort(() => Math.random() - 0.5).forEach(opt => {
                let btn = document.createElement('button');
                btn.className = "option-btn bg-white border-b-[8px] border-gray-200 p-6 rounded-3xl text-4xl font-black text-blue-500 shadow-lg hover:bg-blue-50";
                btn.innerText = opt;
                btn.onclick = () => checkAns(opt, btn);
                grid.appendChild(btn);
            });
        }

        function checkAns(val, btn) {
            const btns = document.querySelectorAll('.option-btn');
            btns.forEach(b => b.disabled = true);

            if (val === correctAns) {
                score += 10;
                btn.classList.add('bg-green-500', 'text-white', 'border-green-700');
                showFeedback(praise[Math.floor(Math.random()*praise.length)], "text-green-600");
            } else {
                score = Math.max(0, score - 5);
                btn.classList.add('bg-red-500', 'text-white', 'border-red-700');
                document.getElementById('game-container').classList.add('shake');
                setTimeout(() => document.getElementById('game-container').classList.remove('shake'), 500);
                showFeedback(motiv[Math.floor(Math.random()*motiv.length)], "text-red-600");
                // Tunjukkan jawaban benar
                btns.forEach(b => {
                    if(parseInt(b.innerText) === correctAns) b.classList.add('bg-green-100', 'border-green-200');
                });
            }
            document.getElementById('score').innerText = score;
            setTimeout(nextQuestion, 2000);
        }

        function showFeedback(text, colorClass) {
            const fb = document.getElementById('feedback');
            fb.innerText = text;
            fb.className = `text-2xl font-black ${colorClass} animate-bounce`;
        }

        function openKey() {
            score = Math.max(0, score - 2);
            document.getElementById('score').innerText = score;
            document.getElementById('key-value').innerText = correctAns;
            document.getElementById('key-modal').style.display = "flex";
        }

        function closeKey() {
            document.getElementById('key-modal').style.display = "none";
        }

        function showResult() {
            document.getElementById('question-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');
            document.getElementById('progress-container').classList.add('hidden');
            document.getElementById('final-msg').innerText = `Hebat! Kamu menyelesaikan Level ${selectedDifficulty} dengan skor ${score} poin!`;
        }
    </script>
</body>
</html>